/**
 * Copyright (c) 2014, 2017, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","knockout","ojs/ojknockout","ojs/ojmessaging"],function(a,g,c){a.Oc=function(){};a.Oc.yE="invalidComponentTracker";a.Oc.g8="ojoptionchange";a.Oc.Qr="messagesShown";a.Oc.bu="messagesHidden";a.Oc.Pr="disabled";a.Oc.JE="readOnly";a.Oc.ov=function(b,d,e,f,h){var k={};h=h.call()[a.Oc.yE];var g;if(b===a.Oc.Pr||b===a.Oc.JE)return g=h&&h.peek()||null,null!==g&&c.isWriteableObservable(h)&&g.ov.call(g,f,e,b,d)&&h.valueHasMutated(),k[b]=d,k};a.Oc._init=function(a,c){var e={};e[a]=
c;return e};a.Oc.gxa=function(b,c,e,f){f=f.call();var h;b===a.Oc.yE&&(h=f[b]?!0:!1)&&a.Oc.gKa(b,f,c,e);return{}};a.Oc.Hxa=function(b,d,e,f){d=g(d);f=f.call()[b];b===a.Oc.yE&&d&&(d.off(a.Oc.g8,a.Oc.hla),f&&c.isWriteableObservable(f)&&(b=f.peek(),b.ve.call(b,e)&&f.valueHasMutated()))};a.Oc.hla=function(b,d){var e=b.data.A5,f,h=b.data.ba,k=b.data.element,g=d.option,m=d.value;(g===a.Oc.Qr||g===a.Oc.bu)&&e&&c.isWriteableObservable(e)&&(f=e.peek())&&f.ov.call(f,h,k,g,m)&&e.valueHasMutated()};a.Oc.gKa=function(b,
d,e,f){d=d[b];var h,k,l;b=g(e);if(c.isObservable(d))l=d.peek(),null==l&&(l=new a.cd,d(l));else throw Error("Binding attribute "+a.Oc.yE+" should be bound to a ko observable.");null!==l&&(c.isWriteableObservable(d)&&(h=f.call(f,"option",a.Oc.Qr),k=f.call(f,"option",a.Oc.bu),l.ov.call(l,f,e,a.Oc.Qr,h),l.ov.call(l,f,e,a.Oc.bu,k),d.valueHasMutated()),e={A5:d,ba:f,element:e},b.on(a.Oc.g8,e,a.Oc.hla))};a.Fa.Gg().Lg({"for":"editableValue",attributes:[a.Oc.yE,a.Oc.Pr,a.Oc.JE],init:a.Oc._init,update:a.Oc.ov,
afterCreate:a.Oc.gxa,beforeDestroy:a.Oc.Hxa});a.cd=function(){this.Init()};o_("InvalidComponentTracker",a.cd,a);a.f.xa(a.cd,a.f,"oj.InvalidComponentTracker");a.cd.Qr="messagesShown";a.cd.bu="messagesHidden";a.cd.Pr="disabled";a.cd.JE="readOnly";a.cd.prototype.Init=function(){a.cd.O.Init.call(this);this.zC=[];this.Pu=[];this.IB=[];this.invalidHidden=this.invalidShown=!1};a.cd.prototype.Jma=function(){var b=null,c=this,e=this.LP,f;f=a.Context.t3().Ne().Ld({description:"Setting Focus to first invalid component."});
this.invalidShown&&(b=this.gY());setTimeout(function(){(b=e===c.LP?b||c.gY():c.gY())&&b.call(b,"Focus");f()},1);return b?!0:!1};a.f.j("InvalidComponentTracker.prototype.focusOnFirstInvalid",{Jma:a.cd.prototype.Jma});a.cd.prototype.showMessages=function(){var a,c,e;if(this.invalidHidden)for(c=this.IB.length,a=0;a<c;a++)this.IB[a]&&(e=this.zC[a].component.call(e,"showMessages"))};a.f.j("InvalidComponentTracker.prototype.showMessages",{showMessages:a.cd.prototype.showMessages});a.cd.prototype.gY=function(){for(var a,
c=0,e=[],f=this.Pu.length,c=0;c<f;c++)(a=this.Pu[c])&&e.push(this.zC[c]);if(0===e.length)return null;e.sort(function(a,b){return a.element.compareDocumentPosition(b.element)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1});return e[0].component};a.cd.prototype.ve=function(a){var c=-1,e=!1;g.each(this.zC,function(e,h){0>c&&h.component===a&&(c=e)});0<=c&&(this.zC.splice(c,1),this.Pu.splice(c,1),this.IB.splice(c,1),this.d2(),e=!0);return e};a.cd.prototype.ov=function(b,c,e,f){var h=b.call(b,"isValid"),k=!0,l,
m=-1;g.each(this.zC,function(a,c){0>m&&c.component===b&&(m=a)});switch(e){case a.cd.Qr:case a.cd.bu:l=!1;f&&(0>m&&(m=this.zC.push({component:b,element:c})-1,this.SGa(m,l)),!h&&a.cd.FZ(f)&&(l=!0,e===a.cd.Qr&&(c=b.call(b,"option",a.cd.Pr),f=b.call(b,"option",a.cd.JE),l=c||f?!1:!0)),k=this.kI(e,m||0,l),this.d2(),k&&(void 0===this.LP&&(this.LP=0),this.LP++));break;case a.cd.Pr:case a.cd.JE:k=!1,f&&(k=this.kI(a.cd.Qr,m||0,!1),k=this.kI(a.cd.bu,m||0,!1)||k,this.d2())}return k};a.cd.prototype.SGa=function(b,
c){void 0===this.Pu[b]&&this.kI(a.cd.Qr,b,c);void 0===this.IB[b]&&this.kI(a.cd.bu,b,c)};a.cd.prototype.d2=function(){this.invalidShown=0<=this.Pu.indexOf(!0);this.invalidHidden=0<=this.IB.indexOf(!0)};a.cd.prototype.kI=function(b,c,e){var f=!1;b=b===a.cd.Qr?this.Pu:b===a.cd.bu?this.IB:[];0<=c&&void 0!==b[c]?(f=b[c]!==e?!0:!1)&&(b[c]=e):(b.push(e),f=!0);return f};a.cd.FZ=function(b){return!a.ta.isValid(b)}});